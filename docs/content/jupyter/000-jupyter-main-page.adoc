[[quickstart-jupyter-page]]
<<<

_v${project.version}_

:linkattrs:

= GeoWave Quickstart Guide: Jupyter Notebook image:geowave-icon-logo-cropped.png[width="28%"]

== Assumptions

This document assumes you understand how to create and configure an EMR cluster for GeoWave. If you need more information on the steps involved in setting up a cluster to support GeoWave visit: 

- link:http://locationtech.github.io/geowave/aws-env.html#[Amazon Web Services EMR]

== Recommended Hardware settings

If you wish to run both jupyter notebook demos you will need to increase the hardware specifications for your emr cluster slightly to support it.

image::aws-gui-method-3.png[scaledwidth="100%",alt="select emr"]

Below are the recommended hardware settings to change for the cluster:

- Root device EBS volume size
** Set this to at least 20gb
- Master
** Edit the Instance Type to be m4.2xlarge
** Do not touch the EBS Storage
- Core
** Edit the Instance Type to be m4.2xlarge
** Select 4 for the Instance count
** Do not touch the EBS Storage or Auto Scaling

== Install Python and Jupyter

To properly run and visualize the results from the Jupyter demo we need to first install python and a few additional packages. We've created a script to do that for you that can be found here:

- Jupyter Bootstrap: http://s3.amazonaws.com/geowave/latest/scripts/emr/jupyter/bootstrap-jupyter.sh

This script will install python and all necessary packages needed for this demo, and it can be run a couple of ways.

. As an additional bootstrap action
** For more information on setting up bootstrap actions: http://locationtech.github.io/geowave/aws-env.html#[Amazon Web Services EMR]

[NOTE]
====
It is recommended to use the Accumulo bootstrap script as the first bootstrap script to setup your cluster. Doing so will let you use both HBase and Accumulo as long as you select HBase as a default application to add to your cluster from AWS. 

- Accumulo Bootstrap: http://s3.amazonaws.com/geowave/latest/scripts/emr/accumulo/bootstrap-geowave.sh
====
. Manually after connecting to the cluster
** Once connected to the cluster simply run the commands below to download and run the script.
+
[source, bash]
----
aws s3 cp s3://geowave-jupyter/install-jupyter-bootstrap.sh ./
chmod +x ./install-jupyter-bootstrap.sh
./install-jupyter-bootstrap.sh
----

== Create and configure the Kernel

In addition to the bootstrap steps that install python and jupyter, you'll need to create the Kernel to run and visualize results from the notebook. The script to create the Kernel can be found at the following link, and it can be run after the cluster has been created and connected to:

- Create Kernel: http://s3.amazonaws.com/geowave/latest/scripts/emr/jupyter/create-configure-kernel.sh

This script depends on spark being installed when it is run, so unfortunately it cannot be run at the same bootstrap step like the script to install python and jupyter. 

. Connect to the EMR Cluster and run the following commands to create the Kernel.
+
[source, bash]
----
aws s3 cp s3://geowave-jupyter/create-configure-kernel.sh ./
chmod +x ./create-configure-kernel.sh
./create-configure-kernel.sh
----

[NOTE]
====
For more information on connecting to the EMR cluster follow the instructions here: http://locationtech.github.io/geowave/aws-env.html#[Amazon Web Services EMR]
====

The script creates the python kernel with environment settings applied so that when the notebook is run pyspark will run spark-submit to set up a yarn application when the kernel is initialized.

== Run the Jupyter notebook

Once the scripts to install python and create the jupyter kernel have been run. You are ready to download the example notebook and run through the KMeans demo.

. Download the example notebook.
+
[source, bash]
----
aws s3 cp s3://geowave-jupyter/notebooks/geowave-gdelt.ipynb ./notebooks/
----

. Launch the jupyter notebook server
+
[source, bash]
----
jupyter notebook ./notebooks --ip=0.0.0.0 --no-browser
----

.. This command will launch a jupyter notebook server from the cluster and output a link to connect to the server that will look like this:
+
[source]
----
http://0.0.0.0:8888/?token=87a7c6eb2d2723b9f2999b7c0d57d66c9a82dd9eae94af8f
----

. Copy and paste that url into your browser, and replace the "0.0.0.0" with the Master Public DNS of your EMR cluster.
+
image::interacting-cluster-1.png[scaledwidth="100%",alt="select emr"]

 .. The final url will look something like this:
+
[source]
----
http://ec2-34-226-244-139.compute-1.amazonaws.com:8888/?token=87a7c6eb2d2723b9f2999b7c0d57d66c9a82dd9eae94af8f
----

. After connecting to the notebook server you should see a list of all notebooks in the browser. Select the geowave-gdelt demo notebook and follow the instructions there once the notebook loads to proceed through the demo. You can run each cell of the notebook by pressing [SHIFT + ENTER] while a cell is in focus.









